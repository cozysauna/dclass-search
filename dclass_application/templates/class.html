{% extends 'base.html' %}

{% block main %}
<div class="wrapper">
    <div class="class_show">
        <h1>{{ cl.class_name}}</h1>
        <li>教師名:{{ cl.teacher }}先生</li>
        <li>年度:{{ cl.year }}年</li>
        <li>学期:{{ cl.term }}</li>
        <li>場所:{{ cl.place}}</li>
        <li>時間:{{ cl.time }}時限目</li>

    </div>
    <div class="a_transition">
        <h1>A率の推移</h1>
        <div class="a_chart">
            {% if user.is_authenticated %}
                <canvas id="chart"></canvas>
            {% else %}
                <p>ログインするとA率を確認できます</p>
            {% endif %}
        </div>
    </div>
    <div class="comment">
        <h1>コメント</h1>
        {% for comment in comments %}
            <p>評価:☆{{ comment.star }}</p> 
            <p>コメント: {{comment.text}}</p>
        {% empty %}
            <p>コメントがありません</p>
        {% endfor %}
        {% if user.is_authenticated %}
            <a href={% url 'add_comment' user.id cl.id %}>
                <p>授業を評価する</p>
            </a>
        {% endif %}
    </div>
    <div class="share">
        <h1>シェア</h1>
        {% comment %} <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">
            <input type="submit" value="twitter" class="twitter btn">
        </a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> {% endcomment %}
        <input type="submit" value="twitter" class="twitter btn">

        <input type="submit" value="LINE" class="line btn">  
        {% if user.is_authenticated %}  
            {% if checked_favorite %}
            <a href={% url 'remove_favorite' user.id cl.id %}>
                <input type="submit" value="お気に入り解除" class="favorite_btn btn"> 
            </a> 
            {% else %}
            <a href={% url 'favorite' user.id cl.id %}>
                <input type="submit" value="お気に入り" class="favorite_btn btn"> 
            </a>
            {% endif %}

        {% else %}
            <p><a href={% url 'account_login' %}>ログイン</a>することでお気に入り登録が可能です</p>
        {% endif %} 
    </div>
    <div class="good">
        <input type="submit" value="いいね" class="btn">
    </div>
    <div class="related_recommend">
        <h1>関連おすすめ授業</h1>
        {% for cl in related_classes %}
            <a href="{% url 'class' cl.id %}">
                <div class="class_result">
                    <div class="class_result_left">
                        <h2>{{ cl.class_name }}</h2>
                        <h5>{{ cl.teacher }}先生</h5>
                    </div>
                    <div class="class_result_middle">
                        <ul>
                            <li>{{ cl.year }}年度</li>
                            <li>{{ cl.term }}</li>
                            <li>{{ cl.place}}</li>
                        </ul>
                    </div>
                    <div class="class_result_right">
                        <ul>
                            <li>いいね{{ cl.favorite }}</li>
                        </ul>
                    </div>
                </div>
            </a>
        {% empty %}
            <p>おすすめクラスはありません</p>
        {% endfor %}
    </div>
</div>


<script>
var ctx = document.getElementById("chart");
var myLineChart = new Chart(ctx, {
// グラフの種類：折れ線グラフを指定
type: 'line',
data: {
    // x軸の各メモリ
    labels: ['2019', '2020', '2021'],
    datasets: [
    {
        label: 'A率',
        data: [72, 77, 56],
        borderColor: "#ec4343",
        backgroundColor: "#00000000"
    },
    ],
},
options: {
    title: {
    display: true,
    text: 'A率の遷移（過去３年）'
    },
    scales: {
    yAxes: [{
        ticks: {
        suggestedMax: 100,
        suggestedMin: 0,
        stepSize: 20,  // 縦メモリのステップ数
        callback: function(value, index, values){
            return  value +  '%'  // 各メモリのステップごとの表記（valueは各ステップの値）
        }
        }
    }]
    },
}
});
  
</script>


{% endblock main %}